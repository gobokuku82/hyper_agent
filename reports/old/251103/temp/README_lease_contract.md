# ì£¼íƒì„ëŒ€ì°¨ ê³„ì•½ì„œ ìƒì„± ì‹œìŠ¤í…œ

## ğŸ“‹ ê°œìš”

ì£¼íƒì„ëŒ€ì°¨ í‘œì¤€ê³„ì•½ì„œë¥¼ DOCX í…œí”Œë¦¿ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ğŸ—‚ï¸ íŒŒì¼ êµ¬ì¡°

```
backend/
â”œâ”€â”€ data/storage/documents/
â”‚   â”œâ”€â”€ ì£¼íƒì„ëŒ€ì°¨ í‘œì¤€ê³„ì•½ì„œ.docx              # ì›ë³¸ í…œí”Œë¦¿
â”‚   â”œâ”€â”€ ì£¼íƒì„ëŒ€ì°¨ í‘œì¤€ê³„ì•½ì„œ_with_placeholders.docx  # í”Œë ˆì´ìŠ¤í™€ë” ë²„ì „ (ìë™ ì‚¬ìš©)
â”‚   â”œâ”€â”€ lease_contract_input_schema.json       # ì…ë ¥ ë°ì´í„° ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ generated/                             # ìƒì„±ëœ ê³„ì•½ì„œ ì €ì¥ í´ë”
â”‚       â””â”€â”€ ì£¼íƒì„ëŒ€ì°¨ê³„ì•½ì„œ_YYYYMMDD_HHMMSS.docx
â”‚
â”œâ”€â”€ app/service_agent/tools/
â”‚   â””â”€â”€ lease_contract_generator_tool.py       # ê³„ì•½ì„œ ìƒì„± Tool
â”‚
â”œâ”€â”€ analyze_template.py                        # í…œí”Œë¦¿ êµ¬ì¡° ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ add_placeholders_to_template.py           # í”Œë ˆì´ìŠ¤í™€ë” ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ test_lease_contract_generation.py         # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
```

## ğŸ”§ ê°œì„  ì‚¬í•­

### 1. í”Œë ˆì´ìŠ¤í™€ë” ê¸°ë°˜ ë§¤í•‘
ê¸°ì¡´: í•˜ë“œì½”ë”©ëœ ì…€ ì¸ë±ìŠ¤ (ì˜ˆ: `table.rows[2].cells[2]`)
ê°œì„ : í”Œë ˆì´ìŠ¤í™€ë” ê²€ìƒ‰ ë° ì¹˜í™˜ ë°©ì‹ (ì˜ˆ: `{{address_road}}` â†’ ì‹¤ì œ ì£¼ì†Œ)

**ì¥ì :**
- âœ… í…œí”Œë¦¿ êµ¬ì¡° ë³€ê²½ì— ìœ ì—°í•˜ê²Œ ëŒ€ì‘
- âœ… ì½”ë“œ ê°€ë…ì„± í–¥ìƒ
- âœ… ìœ ì§€ë³´ìˆ˜ ìš©ì´

### 2. ìë™ í…œí”Œë¦¿ ì„ íƒ
- í”Œë ˆì´ìŠ¤í™€ë” ë²„ì „ì´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ì‚¬ìš©
- ì—†ìœ¼ë©´ ì›ë³¸ í…œí”Œë¦¿ ì‚¬ìš© (í›„ë°© í˜¸í™˜ì„± ìœ ì§€)

### 3. ì „ì²´ í…Œì´ë¸” ìˆœíšŒ
- ëª¨ë“  í…Œì´ë¸”ì„ ìˆœíšŒí•˜ë©° í”Œë ˆì´ìŠ¤í™€ë” ì¹˜í™˜
- ìˆ˜ë™ ë§¤í•‘ ë¶ˆí•„ìš”

## ğŸ“ ì‚¬ìš© ë°©ë²•

### 1. ê¸°ë³¸ ì‚¬ìš© (Python ì½”ë“œ)

```python
from app.service_agent.tools.lease_contract_generator_tool import LeaseContractGeneratorTool

tool = LeaseContractGeneratorTool()

result = await tool.execute(
    address_road="ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
    address_detail="456í˜¸ (101ë™ 10ì¸µ)",
    rental_area="85",
    deposit="500,000,000",
    deposit_hangeul="ì˜¤ì–µ",
    start_date="2024ë…„ 1ì›” 1ì¼",
    end_date="2026ë…„ 1ì›” 1ì¼",
    lessor_name="í™ê¸¸ë™",
    lessee_name="ê¹€ì² ìˆ˜"
)

print(result['docx_path'])  # ìƒì„±ëœ íŒŒì¼ ê²½ë¡œ
```

### 2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
cd backend
python test_lease_contract_generation.py
```

## ğŸ”‘ í•„ìˆ˜ í•„ë“œ

ë°˜ë“œì‹œ ì…ë ¥í•´ì•¼ í•˜ëŠ” í•„ë“œ:
- `address_road`: ë„ë¡œëª… ì£¼ì†Œ
- `deposit`: ë³´ì¦ê¸ˆ
- `start_date`: ê³„ì•½ ì‹œì‘ì¼
- `end_date`: ê³„ì•½ ì¢…ë£Œì¼
- `lessor_name`: ì„ëŒ€ì¸ ì´ë¦„
- `lessee_name`: ì„ì°¨ì¸ ì´ë¦„

## ğŸ“Œ ì„ íƒ í•„ë“œ

ì„ íƒì ìœ¼ë¡œ ì…ë ¥ ê°€ëŠ¥:
- `address_detail`: ìƒì„¸ì£¼ì†Œ (ë™/ì¸µ/í˜¸)
- `rental_area`: ì„ì°¨ ë©´ì 
- `deposit_hangeul`: ë³´ì¦ê¸ˆ í•œê¸€
- `contract_payment`: ê³„ì•½ê¸ˆ
- `monthly_rent`: ì›”ì„¸
- `monthly_rent_day`: ì›”ì„¸ ë‚©ë¶€ì¼
- `management_fee`: ê´€ë¦¬ë¹„
- `lessor_address`: ì„ëŒ€ì¸ ì£¼ì†Œ
- `lessor_phone`: ì„ëŒ€ì¸ ì „í™”
- `lessee_address`: ì„ì°¨ì¸ ì£¼ì†Œ
- `lessee_phone`: ì„ì°¨ì¸ ì „í™”
- `special_terms`: íŠ¹ì•½ì‚¬í•­

## ğŸ› ï¸ í…œí”Œë¦¿ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### í”Œë ˆì´ìŠ¤í™€ë” ì¶”ê°€ ë°©ë²•

1. ì›ë³¸ í…œí”Œë¦¿ì— í”Œë ˆì´ìŠ¤í™€ë” ì¶”ê°€:
```bash
python add_placeholders_to_template.py
```

2. í”Œë ˆì´ìŠ¤í™€ë” í˜•ì‹:
```
{{field_name}}
```

ì˜ˆì‹œ:
- `{{address_road}}` â†’ ë„ë¡œëª… ì£¼ì†Œ
- `{{deposit}}` â†’ ë³´ì¦ê¸ˆ
- `{{lessor_name}}` â†’ ì„ëŒ€ì¸ ì´ë¦„

### ìƒˆ í•„ë“œ ì¶”ê°€í•˜ê¸°

1. `lease_contract_generator_tool.py`ì˜ `_fill_tables()` ë©”ì„œë“œì— í”Œë ˆì´ìŠ¤í™€ë” ë§¤í•‘ ì¶”ê°€:
```python
placeholder_map = {
    "{{new_field}}": fields.get("new_field", ""),
    # ... ê¸°ì¡´ í•„ë“œë“¤
}
```

2. í…œí”Œë¦¿ì— `{{new_field}}` í”Œë ˆì´ìŠ¤í™€ë” ì¶”ê°€

3. ìŠ¤í‚¤ë§ˆ íŒŒì¼ì— í•„ë“œ ì •ì˜ ì¶”ê°€

## âœ… ê²€ì¦ ê²°ê³¼

í…ŒìŠ¤íŠ¸ ê²°ê³¼:
- âœ… ì „ì„¸ ê³„ì•½ì„œ: ëª¨ë“  í•„ë“œ ì •ìƒ ì…ë ¥
- âœ… ì›”ì„¸ ê³„ì•½ì„œ: ëª¨ë“  í•„ë“œ ì •ìƒ ì…ë ¥
- âœ… í”Œë ˆì´ìŠ¤í™€ë” ì¹˜í™˜: ì •ìƒ ì‘ë™
- âœ… íŒŒì¼ ìƒì„±: ì •ìƒ ì‘ë™

## ğŸ“š ì°¸ê³ 

- ìŠ¤í‚¤ë§ˆ ìƒì„¸ ì •ë³´: `lease_contract_input_schema.json`
- í…œí”Œë¦¿ êµ¬ì¡° ë¶„ì„: `python analyze_template.py`
